<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>scitran_client.flywheel_analyzer API documentation</title>
    <meta name="description" content="" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>


  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#scitran_client.flywheel_analyzer.state">state</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#scitran_client.flywheel_analyzer.define_analysis">define_analysis</a></li>
    <li class="mono"><a href="#scitran_client.flywheel_analyzer.find">find</a></li>
    <li class="mono"><a href="#scitran_client.flywheel_analyzer.find_project">find_project</a></li>
    <li class="mono"><a href="#scitran_client.flywheel_analyzer.installed_client">installed_client</a></li>
    <li class="mono"><a href="#scitran_client.flywheel_analyzer.request">request</a></li>
    <li class="mono"><a href="#scitran_client.flywheel_analyzer.run">run</a></li>
    <li class="mono"><a href="#scitran_client.flywheel_analyzer.status">status</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#scitran_client.flywheel_analyzer.FlywheelAnalysisOperation">FlywheelAnalysisOperation</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#scitran_client.flywheel_analyzer.FlywheelFileContainer">FlywheelFileContainer</a></span>
        
          
  <ul>
    <li class="mono"><a href="#scitran_client.flywheel_analyzer.FlywheelFileContainer.find_file">find_file</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#scitran_client.flywheel_analyzer.ShuttingDownException">ShuttingDownException</a></span>
        
        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">scitran_client.flywheel_analyzer</span> module</h1>
  
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer" class="source">
    <pre><code>from __future__ import print_function
from scitran_client import ScitranClient
import time
import json
from concurrent.futures import ThreadPoolExecutor, CancelledError
import traceback
from fnmatch import fnmatch
from collections import namedtuple
import math
from contextlib import contextmanager
import os


def _sleep(seconds):
    '''Sleeps .1 seconds at a time to make KeyboardInterrupt easier to catch.
    '''
    delta = .1
    assert seconds > delta, 'must sleep for longer than {}'.format(delta)
    for _ in range(int(math.ceil(seconds / delta))):
        time.sleep(delta)


state = {}


FlywheelAnalysisOperation = namedtuple('FlywheelAnalysisOperation', [
    'gear_name', 'create_inputs', 'label', 'label_matcher'])


def define_analysis(gear_name, create_inputs, label=None, label_matcher=None):
    '''Defines an analysis operation that can be passed to run(...).

    An analysis operation has a gear name, label (which defaults to
    the gear name), and a function that is used to create the inputs
    to job creation. This function will be supplied a list of analyses
    and a list of acquisitions as keyword arguments. This function will
    be expected to return either a dictionary of the job inputs or a tuple
    with a dictionary of the job inputs and a dictionary of the config
    inputs (to override the default config).
    '''
    label = label or gear_name
    label_matcher = label_matcher or label
    assert find([dict(label=label)], label=label_matcher),\
        'Label matcher for operation {} does not detect this operation.'.format(label)
    return FlywheelAnalysisOperation(gear_name, create_inputs, label, label_matcher)


class FlywheelFileContainer(dict):
    def find_file(self, pattern, **kwargs):
        '''Find a file in this container with a name that matches pattern.

        This will look for a file in this container that matches the supplied
        pattern. Matching uses the fnmatch python library, which does Unix
        filename pattern matching.

        kwargs['default'] - like `next`, when a default is supplied, it will be
        returned when there are no matches. When a default is not supplied, an
        exception will be thrown.

        To find a specific file, you can simply match by name:
        > acquisition.find_file('anatomical.nii.gz')

        To find a file with an extension, you can use a Unix-style pattern:
        > stimulus_onsets.find_file('*.txt')

        When looking for a file that might be missing, supply a default value:
        > partial_set_of_files.find_file('*.txt', default=None)
        '''
        has_default = 'default' in kwargs
        is_analysis = 'job' in self

        # XXX if is_analysis then we should require the file to be an output??
        matches = [
            f for f in self['files']
            if fnmatch(f['name'], pattern)]

        assert len(matches) <= 1, (
            'Multiple matches found for pattern "{}" in container {}. Patterns should uniquely identify a file.'
            .format(pattern, self['_id']))
        if not matches:
            if has_default:
                return kwargs.get('default')
            else:
                raise Exception(
                    'Could not find a match for "{}" in container {}.'
                    .format(pattern, self['_id']))

        f = matches[0]

        return dict(
            type='analysis' if is_analysis else 'acquisition',
            id=self['_id'],
            name=f['name']
        )


def find(items, _constructor_=FlywheelFileContainer, **kwargs):
    '''Finds the first item in `items` that matches the key, value pairs in `kwargs`.

    This is typically used to find an acquisition or analysis by specifying some
    properties to filter on in `kwargs`.

    To find an analysis by label:
    > fa.find(analyses, label='anatomical warp')

    To find an acquisition by measurement:
    > fa.find(acquisitions, measurement='diffusion')
    '''
    # TODO make this have better errors messages for missing files
    result = next((
        item for item in items
        if all(
            v(item[k]) if callable(v) else item[k] == v
            for k, v in kwargs.iteritems()
        )
    ), None)
    return result and _constructor_(result)


def find_project(**kwargs):
    '''Finds a project that matches the key, value pairs in `kwargs`.

    To find a project by label:
    > fa.find_project(label='Reading Skill Study')
    '''
    return find(request('projects'), _constructor_=lambda x: x, **kwargs)


class ShuttingDownException(Exception):
    shutting_down = False


def request(*args, **kwargs):
    # HACK client is a module variable for now. In the future, we should pass client around.
    assert 'client' in state, 'client must be installed in state before using request. See `installed_client`.'
    response = state['client']._request(*args, **kwargs)
    return json.loads(response.text)


def _defaults_for_gear(gear):
    return {
        key: value['default']
        for key, value in gear['config'].iteritems()
        if 'default' in value
    }


def _submit_analysis(session_id, gear_name, job_inputs, job_config, label):
    body = dict(
        job=dict(
            gear=gear_name,
            tags=['ad-hoc'],
            inputs=job_inputs,
            config=job_config,
        ),
        analysis=dict(label=label),
    )

    response = request(
        'sessions/{}/analyses'.format(session_id),
        method='POST',
        params=dict(job=True),
        data=json.dumps(body))
    return response['_id']


def _get_analyses(session_id):
    '''
    We make sure to fetch session.analyses because it respects
    deletion from the UI. session.jobs will show anything that has
    ever been run.
    '''
    session = request('sessions/{}'.format(session_id))
    return session.get('analyses') or []


def _wait_for_analysis(session_id, label):
    '''Waits for analysis to finish.

    Returns latest analyses to optimize upstream code
    '''
    while True:
        analyses = _get_analyses(session_id)
        analysis_response = find(analyses, label=label)
        if analysis_response['job']['state'] == 'complete':
            return analyses
        print(session_id, 'state', analysis_response['job']['state'])
        if ShuttingDownException.shutting_down:
            raise ShuttingDownException()
        _sleep(30)


def _analyze_session(operations, gears_by_name, session):
    acquisitions = None
    session_id = session['_id']
    analyses = _get_analyses(session_id)
    for gear_name, create_inputs, label, label_matcher in operations:
        analysis = find(analyses, label=label_matcher)

        # skip this analysis if we've already done it
        if analysis and analysis['job']['state'] == 'complete':
            continue

        print('waiting for' if analysis else 'starting', label, 'for session', session_id)

        if not analysis:
            # lazily download acquisitions to avoid unnecessary requests for sessions that
            # have completed analysis
            if not acquisitions:
                acquisitions = request('sessions/{}/acquisitions'.format(session_id))
            job_inputs = create_inputs(analyses=analyses, acquisitions=acquisitions, session=session)
            job_config = _defaults_for_gear(gears_by_name[gear_name])

            # When create_inputs returns a tuple, we unpack it into job_inputs and job_config.
            # The job_config returned by create_inputs can override or add to the config
            # defaults we have assembled from the gear manifest.
            if isinstance(job_inputs, tuple):
                job_inputs, job_config = job_inputs[0], dict(job_config, **job_inputs[1])
            _submit_analysis(session_id, gear_name, job_inputs, job_config, label)

        analyses = _wait_for_analysis(session_id, label_matcher)
    print(session_id, 'all analysis complete')


def _wait_for_futures(futures):
    not_done = set(futures)

    def done(f):
        not_done.remove(f)
        try:
            f.result()
        except (ShuttingDownException, CancelledError):
            pass
        except Exception:
            traceback.print_exc()

    for future in futures:
        future.add_done_callback(done)

    try:
        while not_done:
            time.sleep(.1)
    except KeyboardInterrupt as e:
        print('stopping work...', str(e))
        ShuttingDownException.shutting_down = True
        # copying not_done here to avoid issues with other threads modifying it
        # while program is ending
        for future in list(not_done):
            future.cancel()
        raise


@contextmanager
def installed_client(client=None):
    '''
    This context manager handles the installation of a scitran client for use
    in the flywheel analyzer. Most flywheel analyzer code depends on this being
    set up.

    > with installed_client():
    >   print fa.find_project(label='ADHD study') # actually works!
    '''
    # BIG HACK
    state['client'] = client or ScitranClient()
    try:
        yield state['client']
    finally:
        state['client'] = None


def run(operations, project=None, max_workers=10, session_limit=None):
    """Run a sequence of FlywheelAnalysisOperations.

    project - Must be a Flywheel Project. Use find_project(...).
    max_workers - Number of sessions that can be run at the same time. This
        number is dependent on a number of factors: How many CPUs your pipeline
        will use and how many CPUs you can use from your Flywheel Engine instance.
    session_limit - Used to test pipelines out by limiting the number of sessions
        the pipeline code will run on.

    Enabling status mode - By setting the environment variable
    FLYWHEEL_ANALYZER_STATUS to `true`, this method will only print the status
    of this pipeline. It will not run anything.
    """
    gears = [g['gear'] for g in request('gears', params=dict(fields='all'))]
    gears_by_name = {
        gear['name']: gear
        for gear in gears
    }

    # HACK this is seriously a total hack, but is a nice way to see the status
    # of a pipeline without editing code.
    if os.environ.get('FLYWHEEL_ANALYZER_STATUS', '').lower() == 'true':
        status(operations, project)
        return

    for operation in operations:
        assert operation.gear_name in gears_by_name,\
            'operation(name={}, label={}) has an invalid name.'.format(
                operation.gear_name, operation.label)

    sessions = request('projects/{}/sessions'.format(project['_id']))
    # We sort sessions because it adds some predictability to this script.
    # - the script will resume work monitoring/dispatching for previous items
    #   because it iterates over sessions in the same way.
    # - the `session_limit` keyword arg works better for this reason too.
    sessions.sort(key=lambda s: s['timestamp'])
    if session_limit is not None:
        # To ensure the limit on sessions consistently produces the same
        # set of sessions, we will sort the sessions before truncating
        # them.
        sessions = sessions[:session_limit]

    with ThreadPoolExecutor(max_workers=max_workers) as executor:
        futures = [
            executor.submit(_analyze_session, operations, gears_by_name, session)
            for session in sessions
        ]
        _wait_for_futures(futures)


def _session_status(operations, session):
    analyses = _get_analyses(session['_id'])

    started_ops = set()
    completed_ops = set()
    expected_ops = set()

    for op in operations:
        a = find(analyses, label=op.label_matcher)
        if a:
            started_ops.add(op.label)
            if a['job']['state'] == 'complete':
                completed_ops.add(op.label)
        expected_ops.add(op.label)

    if not started_ops:
        return 'not started'

    if completed_ops == expected_ops:
        return 'complete'
    else:
        return 'in progress ({} of {} done)'.format(
            len(completed_ops), len(expected_ops))


def status(operations, project=None, detail=False):
    '''Prints status of operations on this project.

    detail - When true, some session IDs for each status are logged.
    '''
    sessions = request('projects/{}/sessions'.format(project['_id']))
    statuses = [(s, _session_status(operations, s)) for s in sessions]
    result = {}
    for sess, stat in statuses:
        result.setdefault(stat, []).append(sess['_id'])
    for stat, session_ids in sorted(result.iteritems()):
        msg = []
        if detail:
            msg = ['some IDs:', session_ids[:4]]
        print(len(session_ids), stat, *msg)
</code></pre>
  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="scitran_client.flywheel_analyzer.state" class="name">var <span class="ident">state</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="scitran_client.flywheel_analyzer.define_analysis">
    <p>def <span class="ident">define_analysis</span>(</p><p>gear_name, create_inputs, label=None, label_matcher=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Defines an analysis operation that can be passed to run(...).</p>
<p>An analysis operation has a gear name, label (which defaults to
the gear name), and a function that is used to create the inputs
to job creation. This function will be supplied a list of analyses
and a list of acquisitions as keyword arguments. This function will
be expected to return either a dictionary of the job inputs or a tuple
with a dictionary of the job inputs and a dictionary of the config
inputs (to override the default config).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer.define_analysis', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer.define_analysis" class="source">
    <pre><code>def define_analysis(gear_name, create_inputs, label=None, label_matcher=None):
    '''Defines an analysis operation that can be passed to run(...).

    An analysis operation has a gear name, label (which defaults to
    the gear name), and a function that is used to create the inputs
    to job creation. This function will be supplied a list of analyses
    and a list of acquisitions as keyword arguments. This function will
    be expected to return either a dictionary of the job inputs or a tuple
    with a dictionary of the job inputs and a dictionary of the config
    inputs (to override the default config).
    '''
    label = label or gear_name
    label_matcher = label_matcher or label
    assert find([dict(label=label)], label=label_matcher),\
        'Label matcher for operation {} does not detect this operation.'.format(label)
    return FlywheelAnalysisOperation(gear_name, create_inputs, label, label_matcher)
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="scitran_client.flywheel_analyzer.find">
    <p>def <span class="ident">find</span>(</p><p>items, _constructor_=&lt;class &#39;scitran_client.flywheel_analyzer.FlywheelFileContainer&#39;&gt;, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Finds the first item in <code>items</code> that matches the key, value pairs in <code>kwargs</code>.</p>
<p>This is typically used to find an acquisition or analysis by specifying some
properties to filter on in <code>kwargs</code>.</p>
<p>To find an analysis by label:</p>
<blockquote>
<p>fa.find(analyses, label='anatomical warp')</p>
</blockquote>
<p>To find an acquisition by measurement:</p>
<blockquote>
<p>fa.find(acquisitions, measurement='diffusion')</p>
</blockquote></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer.find', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer.find" class="source">
    <pre><code>def find(items, _constructor_=FlywheelFileContainer, **kwargs):
    '''Finds the first item in `items` that matches the key, value pairs in `kwargs`.

    This is typically used to find an acquisition or analysis by specifying some
    properties to filter on in `kwargs`.

    To find an analysis by label:
    > fa.find(analyses, label='anatomical warp')

    To find an acquisition by measurement:
    > fa.find(acquisitions, measurement='diffusion')
    '''
    # TODO make this have better errors messages for missing files
    result = next((
        item for item in items
        if all(
            v(item[k]) if callable(v) else item[k] == v
            for k, v in kwargs.iteritems()
        )
    ), None)
    return result and _constructor_(result)
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="scitran_client.flywheel_analyzer.find_project">
    <p>def <span class="ident">find_project</span>(</p><p>**kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Finds a project that matches the key, value pairs in <code>kwargs</code>.</p>
<p>To find a project by label:</p>
<blockquote>
<p>fa.find_project(label='Reading Skill Study')</p>
</blockquote></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer.find_project', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer.find_project" class="source">
    <pre><code>def find_project(**kwargs):
    '''Finds a project that matches the key, value pairs in `kwargs`.

    To find a project by label:
    > fa.find_project(label='Reading Skill Study')
    '''
    return find(request('projects'), _constructor_=lambda x: x, **kwargs)
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="scitran_client.flywheel_analyzer.installed_client">
    <p>def <span class="ident">installed_client</span>(</p><p>*args, **kwds)</p>
    </div>
    

    
  
    <div class="desc"><p>This context manager handles the installation of a scitran client for use
in the flywheel analyzer. Most flywheel analyzer code depends on this being
set up.</p>
<blockquote>
<p>with installed_client():
  print fa.find_project(label='ADHD study') # actually works!</p>
</blockquote></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer.installed_client', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer.installed_client" class="source">
    <pre><code>@wraps(func)
def helper(*args, **kwds):
    return GeneratorContextManager(func(*args, **kwds))
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="scitran_client.flywheel_analyzer.request">
    <p>def <span class="ident">request</span>(</p><p>*args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer.request', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer.request" class="source">
    <pre><code>def request(*args, **kwargs):
    # HACK client is a module variable for now. In the future, we should pass client around.
    assert 'client' in state, 'client must be installed in state before using request. See `installed_client`.'
    response = state['client']._request(*args, **kwargs)
    return json.loads(response.text)
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="scitran_client.flywheel_analyzer.run">
    <p>def <span class="ident">run</span>(</p><p>operations, project=None, max_workers=10, session_limit=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Run a sequence of FlywheelAnalysisOperations.</p>
<p>project - Must be a Flywheel Project. Use find_project(...).
max_workers - Number of sessions that can be run at the same time. This
    number is dependent on a number of factors: How many CPUs your pipeline
    will use and how many CPUs you can use from your Flywheel Engine instance.
session_limit - Used to test pipelines out by limiting the number of sessions
    the pipeline code will run on.</p>
<p>Enabling status mode - By setting the environment variable
FLYWHEEL_ANALYZER_STATUS to <code>true</code>, this method will only print the status
of this pipeline. It will not run anything.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer.run', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer.run" class="source">
    <pre><code>def run(operations, project=None, max_workers=10, session_limit=None):
    """Run a sequence of FlywheelAnalysisOperations.

    project - Must be a Flywheel Project. Use find_project(...).
    max_workers - Number of sessions that can be run at the same time. This
        number is dependent on a number of factors: How many CPUs your pipeline
        will use and how many CPUs you can use from your Flywheel Engine instance.
    session_limit - Used to test pipelines out by limiting the number of sessions
        the pipeline code will run on.

    Enabling status mode - By setting the environment variable
    FLYWHEEL_ANALYZER_STATUS to `true`, this method will only print the status
    of this pipeline. It will not run anything.
    """
    gears = [g['gear'] for g in request('gears', params=dict(fields='all'))]
    gears_by_name = {
        gear['name']: gear
        for gear in gears
    }

    # HACK this is seriously a total hack, but is a nice way to see the status
    # of a pipeline without editing code.
    if os.environ.get('FLYWHEEL_ANALYZER_STATUS', '').lower() == 'true':
        status(operations, project)
        return

    for operation in operations:
        assert operation.gear_name in gears_by_name,\
            'operation(name={}, label={}) has an invalid name.'.format(
                operation.gear_name, operation.label)

    sessions = request('projects/{}/sessions'.format(project['_id']))
    # We sort sessions because it adds some predictability to this script.
    # - the script will resume work monitoring/dispatching for previous items
    #   because it iterates over sessions in the same way.
    # - the `session_limit` keyword arg works better for this reason too.
    sessions.sort(key=lambda s: s['timestamp'])
    if session_limit is not None:
        # To ensure the limit on sessions consistently produces the same
        # set of sessions, we will sort the sessions before truncating
        # them.
        sessions = sessions[:session_limit]

    with ThreadPoolExecutor(max_workers=max_workers) as executor:
        futures = [
            executor.submit(_analyze_session, operations, gears_by_name, session)
            for session in sessions
        ]
        _wait_for_futures(futures)
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="scitran_client.flywheel_analyzer.status">
    <p>def <span class="ident">status</span>(</p><p>operations, project=None, detail=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Prints status of operations on this project.</p>
<p>detail - When true, some session IDs for each status are logged.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer.status', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer.status" class="source">
    <pre><code>def status(operations, project=None, detail=False):
    '''Prints status of operations on this project.

    detail - When true, some session IDs for each status are logged.
    '''
    sessions = request('projects/{}/sessions'.format(project['_id']))
    statuses = [(s, _session_status(operations, s)) for s in sessions]
    result = {}
    for sess, stat in statuses:
        result.setdefault(stat, []).append(sess['_id'])
    for stat, session_ids in sorted(result.iteritems()):
        msg = []
        if detail:
            msg = ['some IDs:', session_ids[:4]]
        print(len(session_ids), stat, *msg)
</code></pre>
  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="scitran_client.flywheel_analyzer.FlywheelAnalysisOperation" class="name">class <span class="ident">FlywheelAnalysisOperation</span></p>
      
  
    <div class="desc"><p>FlywheelAnalysisOperation(gear_name, create_inputs, label, label_matcher)</p></div>
  <div class="source_cont">
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#scitran_client.flywheel_analyzer.FlywheelAnalysisOperation">FlywheelAnalysisOperation</a></li>
          <li>__builtin__.tuple</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="scitran_client.flywheel_analyzer.FlywheelAnalysisOperation.create_inputs" class="name">var <span class="ident">create_inputs</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="scitran_client.flywheel_analyzer.FlywheelAnalysisOperation.gear_name" class="name">var <span class="ident">gear_name</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="scitran_client.flywheel_analyzer.FlywheelAnalysisOperation.label" class="name">var <span class="ident">label</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 2</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="scitran_client.flywheel_analyzer.FlywheelAnalysisOperation.label_matcher" class="name">var <span class="ident">label_matcher</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 3</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="scitran_client.flywheel_analyzer.FlywheelFileContainer" class="name">class <span class="ident">FlywheelFileContainer</span></p>
      
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer.FlywheelFileContainer', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer.FlywheelFileContainer" class="source">
    <pre><code>class FlywheelFileContainer(dict):
    def find_file(self, pattern, **kwargs):
        '''Find a file in this container with a name that matches pattern.

        This will look for a file in this container that matches the supplied
        pattern. Matching uses the fnmatch python library, which does Unix
        filename pattern matching.

        kwargs['default'] - like `next`, when a default is supplied, it will be
        returned when there are no matches. When a default is not supplied, an
        exception will be thrown.

        To find a specific file, you can simply match by name:
        > acquisition.find_file('anatomical.nii.gz')

        To find a file with an extension, you can use a Unix-style pattern:
        > stimulus_onsets.find_file('*.txt')

        When looking for a file that might be missing, supply a default value:
        > partial_set_of_files.find_file('*.txt', default=None)
        '''
        has_default = 'default' in kwargs
        is_analysis = 'job' in self

        # XXX if is_analysis then we should require the file to be an output??
        matches = [
            f for f in self['files']
            if fnmatch(f['name'], pattern)]

        assert len(matches) <= 1, (
            'Multiple matches found for pattern "{}" in container {}. Patterns should uniquely identify a file.'
            .format(pattern, self['_id']))
        if not matches:
            if has_default:
                return kwargs.get('default')
            else:
                raise Exception(
                    'Could not find a match for "{}" in container {}.'
                    .format(pattern, self['_id']))

        f = matches[0]

        return dict(
            type='analysis' if is_analysis else 'acquisition',
            id=self['_id'],
            name=f['name']
        )
</code></pre>
  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#scitran_client.flywheel_analyzer.FlywheelFileContainer">FlywheelFileContainer</a></li>
          <li>__builtin__.dict</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="scitran_client.flywheel_analyzer.FlywheelFileContainer.find_file">
    <p>def <span class="ident">find_file</span>(</p><p>self, pattern, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Find a file in this container with a name that matches pattern.</p>
<p>This will look for a file in this container that matches the supplied
pattern. Matching uses the fnmatch python library, which does Unix
filename pattern matching.</p>
<p>kwargs['default'] - like <code>next</code>, when a default is supplied, it will be
returned when there are no matches. When a default is not supplied, an
exception will be thrown.</p>
<p>To find a specific file, you can simply match by name:</p>
<blockquote>
<p>acquisition.find_file('anatomical.nii.gz')</p>
</blockquote>
<p>To find a file with an extension, you can use a Unix-style pattern:</p>
<blockquote>
<p>stimulus_onsets.find_file('*.txt')</p>
</blockquote>
<p>When looking for a file that might be missing, supply a default value:</p>
<blockquote>
<p>partial_set_of_files.find_file('*.txt', default=None)</p>
</blockquote></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer.FlywheelFileContainer.find_file', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer.FlywheelFileContainer.find_file" class="source">
    <pre><code>def find_file(self, pattern, **kwargs):
    '''Find a file in this container with a name that matches pattern.
    This will look for a file in this container that matches the supplied
    pattern. Matching uses the fnmatch python library, which does Unix
    filename pattern matching.
    kwargs['default'] - like `next`, when a default is supplied, it will be
    returned when there are no matches. When a default is not supplied, an
    exception will be thrown.
    To find a specific file, you can simply match by name:
    > acquisition.find_file('anatomical.nii.gz')
    To find a file with an extension, you can use a Unix-style pattern:
    > stimulus_onsets.find_file('*.txt')
    When looking for a file that might be missing, supply a default value:
    > partial_set_of_files.find_file('*.txt', default=None)
    '''
    has_default = 'default' in kwargs
    is_analysis = 'job' in self
    # XXX if is_analysis then we should require the file to be an output??
    matches = [
        f for f in self['files']
        if fnmatch(f['name'], pattern)]
    assert len(matches) <= 1, (
        'Multiple matches found for pattern "{}" in container {}. Patterns should uniquely identify a file.'
        .format(pattern, self['_id']))
    if not matches:
        if has_default:
            return kwargs.get('default')
        else:
            raise Exception(
                'Could not find a match for "{}" in container {}.'
                .format(pattern, self['_id']))
    f = matches[0]
    return dict(
        type='analysis' if is_analysis else 'acquisition',
        id=self['_id'],
        name=f['name']
    )
</code></pre>
  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="scitran_client.flywheel_analyzer.ShuttingDownException" class="name">class <span class="ident">ShuttingDownException</span></p>
      
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-scitran_client.flywheel_analyzer.ShuttingDownException', this);">Show source &equiv;</a></p>
  <div id="source-scitran_client.flywheel_analyzer.ShuttingDownException" class="source">
    <pre><code>class ShuttingDownException(Exception):
    shutting_down = False
</code></pre>
  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#scitran_client.flywheel_analyzer.ShuttingDownException">ShuttingDownException</a></li>
          <li>exceptions.Exception</li>
          <li>exceptions.BaseException</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="scitran_client.flywheel_analyzer.ShuttingDownException.args" class="name">var <span class="ident">args</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="scitran_client.flywheel_analyzer.ShuttingDownException.message" class="name">var <span class="ident">message</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="scitran_client.flywheel_analyzer.ShuttingDownException.shutting_down" class="name">var <span class="ident">shutting_down</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
